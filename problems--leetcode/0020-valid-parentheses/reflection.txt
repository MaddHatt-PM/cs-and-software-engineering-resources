Classic stack problem. Optimized it a bit further by using a dictionary for the matching pairs.