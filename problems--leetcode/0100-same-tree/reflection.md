Double recursive DFS (Depth-First Search) with extra comparisons.